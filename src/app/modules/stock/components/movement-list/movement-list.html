<h2 class="titulo">Historial de Movimientos</h2>

<div class="filtros">
  <button (click)="setFiltro('todos')">Todos</button>
  <button (click)="setFiltro('ingreso')">Ingresos</button>
  <button (click)="setFiltro('egreso')">Egresos</button>
</div>

<table class="tabla">
  <thead>
    <tr>
      <th>Fecha</th>
      <th>Modelo</th>
      <th>Movimiento</th>
      <th>Comentario</th>
    </tr>
  </thead>
  <tbody>
    @for (m of filtered; track m.id) {
      <tr>
        <td>{{ m.fecha }}</td>
        <td>
          <details>
            <summary>{{ m.modelo }}</summary>
            <ul class="mods">
              @for (it of m.items; track it.modulo) {
                <li>
                  <span class="modulo">{{ it.modulo }}</span>
                  <span class="cantidad">x{{ it.cantidad }}</span>
                </li>
              } @empty {
                <li class="muted">Sin módulos</li>
              }
            </ul>
          </details>
        </td>
        <td>
          @if (m.tipo === 'ingreso') {
            <span class="badge ingreso">↑ Ingreso</span>
          } @else {
            <span class="badge egreso">↓ Egreso</span>
          }
        </td>
        <td>{{ m.comentario }}</td>
      </tr>
    } @empty {
      <tr><td colspan="4">No hay movimientos</td></tr>
    }
  </tbody>
</table>
